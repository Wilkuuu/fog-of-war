<ion-menu side="start" menuId="main-menu" [contentId]="contentId">
  <ion-header>
    <ion-toolbar color="primary">
      <ion-title>Menu</ion-title>
    </ion-toolbar>
  </ion-header>
  <ion-content>
    <ion-list>
      <ion-item button (click)="selectVideo()">
        <ion-icon name="videocam-outline" slot="start"></ion-icon>
        <ion-label>
          <h2>Select Video</h2>
          <p>Choose a video from your device</p>
        </ion-label>
      </ion-item>

      <ion-item>
        <ion-label>
          <h2>Brush Size</h2>
          <p>Adjust the size of the fog removal tool</p>
        </ion-label>
      </ion-item>
      
      <ion-item>
        <ion-segment [(ngModel)]="brushSizeStr" (ionChange)="changeBrushSize($event)" style="width: 100%;">
          <ion-segment-button value="18">
            <ion-label>Small</ion-label>
          </ion-segment-button>
          <ion-segment-button value="50">
            <ion-label>Medium</ion-label>
          </ion-segment-button>
          <ion-segment-button value="80">
            <ion-label>Large</ion-label>
          </ion-segment-button>
        </ion-segment>
      </ion-item>

      <ion-item *ngIf="videoUrl">
        <ion-button expand="block" fill="outline" color="success" (click)="removeAllFog(); closeMenu()">
          <ion-icon name="eye-outline" slot="start"></ion-icon>
          Remove All Fog
        </ion-button>
      </ion-item>

      <ion-item *ngIf="videoUrl">
        <ion-button expand="block" fill="outline" (click)="undo(); closeMenu()">
          <ion-icon name="arrow-undo-outline" slot="start"></ion-icon>
          Undo
        </ion-button>
      </ion-item>

      <ion-item *ngIf="videoUrl">
        <ion-button expand="block" fill="outline" (click)="resetFog(); closeMenu()">
          <ion-icon name="refresh" slot="start"></ion-icon>
          Reset Fog
        </ion-button>
      </ion-item>

      <ion-item *ngIf="videoUrl">
        <ion-button expand="block" fill="outline" (click)="selectVideo(); closeMenu()">
          <ion-icon name="swap-horizontal" slot="start"></ion-icon>
          Change Video
        </ion-button>
      </ion-item>
    </ion-list>
  </ion-content>
</ion-menu>

<div class="ion-page" [id]="contentId" style="height: 100vh; display: flex; flex-direction: column;">
  <ion-content [fullscreen]="true" class="video-content" style="flex: 1; min-height: 0;">
    <div *ngIf="!videoUrl" class="empty-state">
      <div class="empty-state-content">
        <div class="empty-state-icon">
          <ion-icon name="videocam-outline"></ion-icon>
        </div>
        <h1 class="empty-state-title">Fog of War</h1>
        <p class="empty-state-description">Select a video to begin revealing hidden content</p>
        <ion-button class="select-video-button" expand="block" (click)="selectVideo()">
          <ion-icon name="videocam-outline" slot="start"></ion-icon>
          Select Video
        </ion-button>
      </div>
    </div>

    <div *ngIf="videoUrl" class="video-container">
      <video 
        #videoElement 
        [src]="videoUrl" 
        autoplay 
        muted 
        loop
        playsinline
        style="display: none;">
      </video>
      
      <canvas 
        #canvasElement 
        class="fog-canvas"
        (touchstart)="onCanvasTouch($event)"
        (touchmove)="onCanvasTouch($event)"
        (touchend)="onCanvasTouchEnd($event)"
        (mousedown)="onCanvasMouseDown($event)"
        (mousemove)="onCanvasMouseMove($event)"
        (mouseup)="onCanvasMouseUp()"
        (mouseleave)="onCanvasMouseUp()">
      </canvas>
    </div>
    
    <!-- Floating hamburger menu button - always visible -->
    <button class="menu-button" (click)="openMenu()" type="button">
      <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path d="M3 12H21M3 6H21M3 18H21" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
      </svg>
    </button>
  </ion-content>
</div>

